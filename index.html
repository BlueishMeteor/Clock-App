<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Clock App</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 20px;
      background: #f9f9f9;
    }
    #timer {
      font-size: 48px;
      margin-bottom: 10px;
    }
    button {
      margin: 5px;
      padding: 10px 15px;
    }
    #menu {
      display: none;
      margin-top: 20px;
      border: 1px solid #ccc;
      padding: 15px;
      background: white;
    }
  </style>
</head>
<body>

  <h1>Clock App</h1>
  <div id="timer">03:00</div>
  <div id="controls">
    <button onclick="startTimer()">Start</button>
    <button onclick="pauseTimer()">Pause</button>
    <button onclick="resetTimer()">Reset</button>
    <button onclick="previousSection()">⏮️</button>
    <button onclick="nextSection()">⏭️</button>
  </div>

  <button onclick="toggleMenu()">Toggle Schedule Menu</button>

  <div id="menu">
    <h2>Schedule</h2>
    <ul id="scheduleList"></ul>
    <button onclick="addSection()">Add Section</button>
    <button onclick="removeSection()">Remove Last</button>
    <button onclick="dropSection()">Drop Current</button>
  </div>

  <script>
    let timerInterval;
    let totalSeconds = 180;
    let isPaused = false;

    let schedule = [180, 300, 120]; // example schedule in seconds
    let currentSectionIndex = 0;

    function updateTimerDisplay() {
      const minutes = Math.floor(totalSeconds / 60).toString().padStart(2, '0');
      const seconds = (totalSeconds % 60).toString().padStart(2, '0');
      document.getElementById('timer').textContent = `${minutes}:${seconds}`;
    }

    function startTimer() {
      if (timerInterval || totalSeconds <= 0) return;
      timerInterval = setInterval(() => {
        if (!isPaused) {
          totalSeconds--;
          updateTimerDisplay();
          if (totalSeconds <= 0) {
            clearInterval(timerInterval);
            timerInterval = null;
            nextSection();
          }
        }
      }, 1000);
    }

    function pauseTimer() {
      isPaused = !isPaused;
    }

    function resetTimer() {
      totalSeconds = schedule[currentSectionIndex];
      updateTimerDisplay();
      clearInterval(timerInterval);
      timerInterval = null;
    }

    function nextSection() {
      currentSectionIndex = (currentSectionIndex + 1) % schedule.length;
      resetTimer();
    }

    function previousSection() {
      currentSectionIndex = (currentSectionIndex - 1 + schedule.length) % schedule.length;
      resetTimer();
    }

    function toggleMenu() {
      const menu = document.getElementById("menu");
      menu.style.display = menu.style.display === "none" ? "block" : "none";
      renderSchedule();
    }

    function renderSchedule() {
      const ul = document.getElementById("scheduleList");
      ul.innerHTML = '';
      schedule.forEach((sec, index) => {
        const li = document.createElement("li");
        li.textContent = `Section ${index + 1}: ${Math.floor(sec / 60)}m ${sec % 60}s`;
        if (index === currentSectionIndex) li.style.fontWeight = 'bold';
        ul.appendChild(li);
      });
    }

    function addSection() {
      schedule.push(180); // Add 3 minutes by default
      renderSchedule();
    }

    function removeSection() {
      if (schedule.length > 1) {
        schedule.pop();
        if (currentSectionIndex >= schedule.length) {
          currentSectionIndex = schedule.length - 1;
        }
        resetTimer();
        renderSchedule();
      }
    }

    function dropSection() {
      if (schedule.length > 1) {
        schedule.splice(currentSectionIndex, 1);
        currentSectionIndex = Math.min(currentSectionIndex, schedule.length - 1);
        resetTimer();
        renderSchedule();
      }
    }

    // Make all functions globally accessible
    window.startTimer = startTimer;
    window.pauseTimer = pauseTimer;
    window.resetTimer = resetTimer;
    window.previousSection = previousSection;
    window.nextSection = nextSection;
    window.toggleMenu = toggleMenu;
    window.addSection = addSection;
    window.removeSection = removeSection;
    window.dropSection = dropSection;

    // Initial setup
    window.onload = () => {
      resetTimer();
      renderSchedule();
    };
  </script>
</body>
</html>
