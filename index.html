<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Schedule Timer</title>
  <style>
    body {
      font-family: sans-serif;
      background: #111;
      color: white;
      text-align: center;
      padding: 2rem;
    }
    #timer {
      font-size: 5em;
      margin-bottom: 1rem;
    }
    button {
      margin: 0.5rem;
      padding: 0.75rem 1.5rem;
      font-size: 1.2rem;
    }
    #menu {
      display: none;
      margin-top: 1rem;
    }
    #sectionList {
      list-style: none;
      padding: 0;
    }
    #sectionList li {
      margin: 0.5rem 0;
    }
  </style>
</head>
<body>
  <div id="timer">3:00</div>
  <button onclick="startTimer()">Start</button>
  <button onclick="pauseTimer()">Pause</button>
  <button onclick="resetTimer()">Reset</button>
  <button onclick="previousSection()">Previous</button>
  <button onclick="nextSection()">Next</button>
  <button onclick="toggleMenu()">Toggle Schedule Menu</button>

  <div id="menu">
    <ul id="sectionList"></ul>
    <input type="text" id="newSectionName" placeholder="Section Name"/>
    <input type="number" id="newSectionMinutes" placeholder="Minutes" />
    <input type="number" id="newSectionSeconds" placeholder="Seconds" />
    <button onclick="addSection()">Add Section</button>
    <button onclick="removeSection()">Remove Last Section</button>
    <button onclick="dropSection()">Drop Current Section</button>
  </div>

  <script>
    let schedule = [
      { name: "Focus", minutes: 3, seconds: 0 },
      { name: "Break", minutes: 1, seconds: 0 }
    ];

    let currentSectionIndex = 0;
    let interval = null;
    let remainingTime = getTotalSeconds(schedule[currentSectionIndex]);
    let isRunning = false;

    function getTotalSeconds(section) {
      return section.minutes * 60 + section.seconds;
    }

    function formatTime(seconds) {
      const m = Math.floor(seconds / 60).toString().padStart(1, '0');
      const s = (seconds % 60).toString().padStart(2, '0');
      return `${m}:${s}`;
    }

    function updateTimerDisplay() {
      const timer = document.getElementById("timer");
      timer.textContent = formatTime(remainingTime);
    }

    function startTimer() {
      if (isRunning || remainingTime <= 0) return;
      isRunning = true;
      interval = setInterval(() => {
        if (remainingTime > 0) {
          remainingTime--;
          updateTimerDisplay();
        } else {
          clearInterval(interval);
          isRunning = false;
        }
      }, 1000);
    }

    function pauseTimer() {
      clearInterval(interval);
      isRunning = false;
    }

    function resetTimer() {
      pauseTimer();
      remainingTime = getTotalSeconds(schedule[currentSectionIndex]);
      updateTimerDisplay();
    }

    function previousSection() {
      if (currentSectionIndex > 0) {
        currentSectionIndex--;
        resetTimer();
        renderSectionList();
      }
    }

    function nextSection() {
      if (currentSectionIndex < schedule.length - 1) {
        currentSectionIndex++;
        resetTimer();
        renderSectionList();
      }
    }

    function toggleMenu() {
      const menu = document.getElementById("menu");
      menu.style.display = menu.style.display === "none" ? "block" : "none";
      renderSectionList();
    }

    function renderSectionList() {
      const list = document.getElementById("sectionList");
      list.innerHTML = "";
      schedule.forEach((section, index) => {
        const li = document.createElement("li");
        li.textContent = `${index === currentSectionIndex ? "ðŸ‘‰ " : ""}${section.name} - ${section.minutes}:${section.seconds.toString().padStart(2, "0")}`;
        list.appendChild(li);
      });
    }

    function addSection() {
      const name = document.getElementById("newSectionName").value || "New Section";
      const minutes = parseInt(document.getElementById("newSectionMinutes").value) || 0;
      const seconds = parseInt(document.getElementById("newSectionSeconds").value) || 0;
      schedule.push({ name, minutes, seconds });
      renderSectionList();
    }

    function removeSection() {
      if (schedule.length > 1) {
        schedule.pop();
        if (currentSectionIndex >= schedule.length) {
          currentSectionIndex = schedule.length - 1;
        }
        resetTimer();
        renderSectionList();
      }
    }

    function dropSection() {
      if (schedule.length > 1) {
        schedule.splice(currentSectionIndex, 1);
        if (currentSectionIndex >= schedule.length) {
          currentSectionIndex = schedule.length - 1;
        }
        resetTimer();
        renderSectionList();
      }
    }

    // Make functions accessible globally
    window.startTimer = startTimer;
    window.pauseTimer = pauseTimer;
    window.resetTimer = resetTimer;
    window.previousSection = previousSection;
    window.nextSection = nextSection;
    window.toggleMenu = toggleMenu;
    window.addSection = addSection;
    window.removeSection = removeSection;
    window.dropSection = dropSection;

    window.onload = () => {
      updateTimerDisplay();
      renderSectionList();
    };
  </script>
</body>
</html>
